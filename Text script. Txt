function main(workbook: ExcelScript.Workbook) {
  // קבלת הגיליון הפעיל
  let sheet = workbook.getActiveWorksheet();
  let usedRange = sheet.getUsedRange();

  // אם הגיליון ריק לגמרי, צא מהפונקציה
  if (!usedRange) {
    return;
  }

  // מציאת אינדקס השורה האחרונה שיש בה נתונים בגיליון
  let lastRowIndex = usedRange.getLastRow().getRowIndex();
  
  // חישוב כמה שורות צריך לקרוא (מסך הכל פחות שורת הכותרת הראשונה)
  // אנו מתחילים משורה 2 (אינדקס 1), לכן הגובה הוא סך השורות פחות 1
  let rowCount = lastRowIndex; 

  // אם יש רק כותרת או אין נתונים, עצור
  if (rowCount < 1) {
    return;
  }

  // --- שלב 1: קריאת נתונים ספציפיים לזיכרון ---

  // קריאת עמודות X ו-Y (עמודות 23 ו-24 באינדקס 0)
  // הפרמטרים: (שורת התחלה, עמודת התחלה, מספר שורות, מספר עמודות)
  let sourceRange = sheet.getRangeByIndexes(1, 23, rowCount, 2);
  let sourceValues = sourceRange.getValues();

  // קריאת עמודות AS ו-AT (עמודות 44 ו-45 באינדקס 0)
  let targetRange = sheet.getRangeByIndexes(1, 44, rowCount, 2);
  let targetValues = targetRange.getValues();

  // --- שלב 2: ביצוע הלוגיקה בזיכרון ---
  
  for (let i = 0; i < rowCount; i++) {
    // שליפת הערכים הנוכחיים (עבור קריאות הקוד)
    // עמודה 0 במערך המקומי = X או AS
    // עמודה 1 במערך המקומי = Y או AT
    
    let valAS = String(targetValues[i][0]); // הערך ב-AS
    let valAT = String(targetValues[i][1]); // הערך ב-AT
    
    // בדיקה עבור עמודה AS (החלפה בערך מ-X)
    if (valAS.toLowerCase().indexOf("z") !== -1) {
      targetValues[i][0] = sourceValues[i][0]; // העתקת הערך מ-X
    }

    // בדיקה עבור עמודה AT (החלפה בערך מ-Y)
    if (valAT.toLowerCase().indexOf("z") !== -1) {
      targetValues[i][1] = sourceValues[i][1]; // העתקת הערך מ-Y
    }
  }

  // --- שלב 3: כתיבת התוצאות חזרה לאקסל ---
  // אנו כותבים חזרה רק את טווח המטרה (AS:AT) כי רק הוא השתנה
  targetRange.setValues(targetValues);
}
