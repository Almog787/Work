function main(workbook: ExcelScript.Workbook) {
  // קבלת הגיליון הפעיל
  let selectedSheet = workbook.getActiveWorksheet();
  
  // קבלת הטווח המשומש בגיליון (כדי לא לרוץ על מיליון שורות סתם)
  let usedRange = selectedSheet.getUsedRange();
  
  // אם הגיליון ריק, עצור
  if (!usedRange) {
    return;
  }

  // טעינת הערכים לזיכרון (מערך דו-ממדי) לביצועים מהירים
  let values = usedRange.getValues();
  let rowCount = values.length;
  
  // מציאת אינדקס העמודה שבה מתחיל הטווח (למקרה שהטבלה לא מתחילה ב-A1)
  let startColIndex = usedRange.getColumnIndex();
  let startRowIndex = usedRange.getRowIndex();

  // הגדרת מספרי העמודות (בסיס 0: A=0, B=1...)
  // X = 23
  // Y = 24
  // AS = 44
  // AT = 45
  const colX_Index = 23;
  const colY_Index = 24;
  const colAS_Index = 44;
  const colAT_Index = 45;

  // לולאה העוברת על כל השורות בטווח
  for (let i = 0; i < rowCount; i++) {
    // חישוב מספר השורה האמיתי באקסל
    let realRowNumber = startRowIndex + i + 1;

    // אנחנו רוצים להתחיל רק משורה 2 ומטה
    if (realRowNumber >= 2) {
      
      // חישוב האינדקס היחסי בתוך המערך 'values'
      // (למקרה שהטווח לא מתחיל בעמודה A, אנו מחסרים את startColIndex)
      let relativeColAS = colAS_Index - startColIndex;
      let relativeColAT = colAT_Index - startColIndex;
      let relativeColX = colX_Index - startColIndex;
      let relativeColY = colY_Index - startColIndex;

      // בדיקה אם העמודות הללו בכלל קיימות בטווח הנתונים שנמצא
      if (relativeColAS >= 0 && relativeColAT < values[i].length) {
        
        // --- בדיקה עבור עמודה AS ---
        let contentAS = String(values[i][relativeColAS]);
        // בדיקה אם מכיל 'z' או 'Z'
        if (contentAS.toLowerCase().indexOf("z") !== -1) {
           // העתקה מ-X ל-AS
           values[i][relativeColAS] = values[i][relativeColX];
        }

        // --- בדיקה עבור עמודה AT ---
        let contentAT = String(values[i][relativeColAT]);
        // בדיקה אם מכיל 'z' או 'Z'
        if (contentAT.toLowerCase().indexOf("z") !== -1) {
           // העתקה מ-Y ל-AT
           values[i][relativeColAT] = values[i][relativeColY];
        }
      }
    }
  }

  // כתיבת הערכים המעודכנים חזרה לאקסל בפעולה אחת (מהיר מאוד)
  usedRange.setValues(values);
}
