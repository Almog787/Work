function main(workbook: ExcelScript.Workbook) {
  const sheet = workbook.getActiveWorksheet();
  const usedRange = sheet.getUsedRange();

  if (!usedRange) return;

  // חישוב גודל הטווח
  const lastRowIndex = usedRange.getLastRow().getRowIndex();
  const rowCount = lastRowIndex; // מתחילים משורה 2 (מדלגים על כותרת)

  if (rowCount < 1) return;

  // קריאת העמודות הרלוונטיות בלבד לזיכרון
  // X=23, Y=24 | AS=44, AT=45
  const sourceRange = sheet.getRangeByIndexes(1, 23, rowCount, 2);
  const targetRange = sheet.getRangeByIndexes(1, 44, rowCount, 2);

  // טעינת הערכים (פעולת קריאה מהשרת)
  const sourceValues = sourceRange.getValues();
  const targetValues = targetRange.getValues();

  // הגדרת ביטוי רגולרי לחיפוש האות z (הדגל 'i' אומר להתעלם מאותיות גדולות/קטנות)
  const zPattern = /z/i;
  
  // משתנה עזר כדי לדעת אם בכלל צריך לשמור בסוף
  let hasChanges = false;

  // לולאה מהירה על הזיכרון
  for (let i = 0; i < rowCount; i++) {
    // שליפת הערכים הנוכחיים ב-AS ו-AT
    // אנו בודקים את הטייפ כדי למנוע קריסה בתאים ריקים או מספרים
    let valAS = targetValues[i][0];
    let valAT = targetValues[i][1];

    // --- בדיקה עבור AS ---
    // תנאי אופטימלי: בודק אם זה טקסט ורק אז מריץ את החיפוש
    if (typeof valAS === 'string' && zPattern.test(valAS)) {
      targetValues[i][0] = sourceValues[i][0]; // העתקה מ-X
      hasChanges = true;
    }

    // --- בדיקה עבור AT ---
    if (typeof valAT === 'string' && zPattern.test(valAT)) {
      targetValues[i][1] = sourceValues[i][1]; // העתקה מ-Y
      hasChanges = true;
    }
  }

  // שמירה: כותבים לאקסל רק אם באמת בוצע שינוי כלשהו
  if (hasChanges) {
    targetRange.setValues(targetValues);
    console.log("הנתונים עודכנו בהצלחה.");
  } else {
    console.log("לא נמצאה האות z, לא בוצעו שינויים.");
  }
}
