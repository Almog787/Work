function main(workbook: ExcelScript.Workbook) {
  // 1. הגדרת רשימת הגיליונות והטבלאות הנדרשות
  const sheets = [
    { name: "בקרים", table: "ControllersTable", headers: [["שם הבקר", "סוג משרה", "מכסת שעות חודשית", "שעות שבוצעו", "יתרה לביצוע"]] },
    { name: "מכסות_משימות", table: "TasksTable", headers: [["שם התחנה", "יעד בקרות חודשי", "בוצע בפועל", "עדיפות"]] },
    { name: "אילוצים_שבועיים", table: "ConstraintsTable", headers: [["שם הבקר", "ראשון", "שני", "שלישי", "רביעי", "חמישי", "שישי", "מוצ\"ש"]] },
    { name: "לוח_שיבוץ_סופי", table: "FinalSchedule", headers: [["תאריך", "שם הבקר", "שעות משמרת", "תחנה/גזרה", "הערות חריגה"]] }
  ];

  sheets.forEach(s => {
    // מחיקת גיליון קיים אם יש כזה (כדי להתחיל מחדש) - זהירות: מוחק נתונים!
    let currentSheet = workbook.getWorksheet(s.name);
    if (currentSheet) {
      currentSheet.delete();
    }
    
    // יצירת גיליון חדש
    let newSheet = workbook.addWorksheet(s.name);
    
    // הוספת כותרות
    let headerRange = newSheet.getRangeByIndexes(0, 0, 1, s.headers[0].length);
    headerRange.setValues(s.headers);
    
    // הפיכה לטבלה (Excel Table)
    let table = workbook.addTable(headerRange, true);
    table.setName(s.table);
    
    // עיצוב בסיסי
    headerRange.getFormat().getFont().setBold(true);
    headerRange.getFormat().getFill().setColor("#4472C4");
    headerRange.getFormat().getFont().setColor("white");

    // הוספת שורות דוגמה בסיסיות
    if (s.name === "בקרים") {
      newSheet.getRange("A2:E2").setValues([["ישראל ישראלי", "משרה מלאה", 160, 0, 160]]);
    } else if (s.name === "מכסות_משימות") {
      newSheet.getRange("A2:D2").setValues([["אלנבי", 40, 0, "גבוהה"]]);
    }

    // התאמת רוחב עמודות אוטומטית
    newSheet.getUsedRange().getFormat().autofitColumns();
  });

  // העברת הפוקוס לגיליון האילוצים (שבו המשתמש עובד בדרך כלל)
  workbook.getWorksheet("אילוצים_שבועיים").activate();
  
  console.log("השלד למערכת הניהול נבנה בהצלחה! כעת ניתן למלא את הנתונים בטבלאות.");
}
